# Malware Safety Guidelines

## ‚ö†Ô∏è Critical Safety Information

This guide provides comprehensive safety procedures for handling live malware samples included in Phase 5 of the cybersecurity datasets downloader.

**STOP AND READ THIS ENTIRE DOCUMENT** before downloading or handling any malware samples.

## üö® Legal Disclaimer

- **Legal Responsibility:** You are solely responsible for complying with local, state, and federal laws regarding malware possession and research
- **Authorization:** Ensure you have proper authorization from your organization
- **Purpose:** Use malware samples ONLY for legitimate security research, education, or defensive purposes
- **Prohibited Uses:** Never use for malicious activities, unauthorized access, or illegal purposes
- **Liability:** The dataset maintainers assume no liability for misuse

**Research your local laws before proceeding!**

## üñ•Ô∏è Isolated Environment Requirements

### Mandatory Requirements

You **MUST** use an isolated environment. Choose one:

#### Option 1: Virtual Machine (Recommended)

**VMware Workstation/Fusion:**
```bash
# Recommended VM settings:
- OS: Windows 10/11 or Linux
- RAM: 4GB minimum
- Disk: 50GB minimum
- Network: Host-only or disabled
- Snapshots: Multiple clean snapshots
```

**VirtualBox:**
```bash
# Recommended settings:
- Network Adapter: Host-only Adapter
- Shared Folders: Disabled
- USB: Disabled
- Shared Clipboard: Disabled
```

**QEMU/KVM:**
```bash
# Launch with no network:
qemu-system-x86_64 -hda malware_analysis.qcow2 -m 4G -net none
```

#### Option 2: Docker Container (Advanced)

```dockerfile
# Isolated malware analysis container
FROM ubuntu:22.04

# Disable networking
RUN echo "nameserver 0.0.0.0" > /etc/resolv.conf

# Install analysis tools
RUN apt-get update && apt-get install -y \
    python3 python3-pip \
    binutils file strings \
    && rm -rf /var/lib/apt/lists/*

# No external network access
NETWORK none
```

#### Option 3: Air-Gapped Physical Machine

- Dedicated hardware with no network card
- Or physically disconnected network
- Regularly wiped and reimaged

### Network Isolation

**CRITICAL:** Malware samples MUST NOT have internet access.

#### Verify Network Isolation:

**Windows:**
```powershell
# Should show no connectivity
ping 8.8.8.8
Test-NetConnection google.com

# Disable all adapters
Get-NetAdapter | Disable-NetAdapter
```

**Linux:**
```bash
# Should fail
ping -c 1 8.8.8.8

# Bring down all interfaces
sudo ip link set eth0 down
sudo ip link set wlan0 down

# Verify
ip addr show
```

**VM Settings:**
- VMware: Set network to "Host-only" or "Disabled"
- VirtualBox: Set adapter to "Host-only Adapter" or "Not attached"
- Hyper-V: Use "Internal Network" or no network adapter

## üì∏ Snapshots & Backups

### Before ANY Malware Work:

1. **Take Clean Snapshot:**
   ```bash
   # VMware
   vmrun snapshot /path/to/vm.vmx "Clean_State"
   
   # VirtualBox
   VBoxManage snapshot "MalwareVM" take "Clean_State"
   ```

2. **Document Snapshot:**
   - Note date and time
   - Document installed tools
   - Keep snapshot description

3. **Test Restore:**
   - Verify you can restore successfully
   - Practice the restore process

### After Each Analysis Session:

1. Restore to clean snapshot
2. Take new snapshot if you made configuration changes
3. Keep multiple snapshot points

## üîê Handling Malware Archives

### Password-Protected Archives

Most malware samples are stored in password-protected archives:

**Common Passwords:**
- `infected`
- `malware`
- `virus`

### Extraction Safety:

```bash
# Extract in isolated VM only
unzip -P infected malware_samples.zip -d /tmp/malware/

# Verify contents before extraction
unzip -l malware_samples.zip

# NEVER extract on host system
# NEVER extract with network access enabled
```

### File Handling:

```bash
# Check file type without executing
file suspicious.exe

# View strings without executing
strings suspicious.exe | less

# Calculate hash
sha256sum suspicious.exe
```

## üõ°Ô∏è Security Measures

### Before Starting:

- [ ] VM/container is isolated (no network)
- [ ] Clean snapshot exists and tested
- [ ] Antivirus disabled in VM (intentionally)
- [ ] Host system antivirus is ACTIVE
- [ ] Shared folders disabled
- [ ] Clipboard sharing disabled
- [ ] USB passthrough disabled
- [ ] Guest-to-host dragging disabled

### During Analysis:

- [ ] Never transfer files to host without sanitization
- [ ] Never enable networking "just for a moment"
- [ ] Document everything you do
- [ ] Use analysis tools, not direct execution
- [ ] Monitor VM resource usage

### After Analysis:

- [ ] Restore to clean snapshot
- [ ] Securely delete any exported files
- [ ] Review logs for any suspicious activity
- [ ] Update documentation

## üî¨ Safe Analysis Practices

### Static Analysis (Safer)

Analyze without executing:

```bash
# File information
file malware.exe
exiftool malware.exe

# Strings analysis
strings malware.exe | grep -i "http\|ftp\|password"

# PE analysis (Windows executables)
pefile-dump malware.exe

# Disassembly
objdump -d malware.bin

# YARA scanning
yara rules.yar malware_samples/
```

### Dynamic Analysis (Riskier)

Execute in monitored environment:

```bash
# Process monitoring
procmon  # Windows
strace ./malware  # Linux

# Network monitoring (on host-only network)
tcpdump -i eth0 -w capture.pcap

# System monitoring
regshot  # Windows registry
auditd   # Linux
```

**NEVER** perform dynamic analysis:
- On host system
- With internet access
- Without monitoring
- Without clean snapshots

## üì¶ Specific Repository Warnings

### theZoo (GitHub: ytisf/theZoo)

- **Risk Level:** ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è VERY HIGH
- **Contains:** Live, functional malware samples
- **Archive Password:** `infected`
- **Special Notes:** 
  - Includes ransomware, worms, trojans
  - Some samples have network capabilities
  - Contains destructive payloads

### vx-underground (GitHub: vxunderground/MalwareSourceCode)

- **Risk Level:** ‚ö†Ô∏è‚ö†Ô∏è‚ö†Ô∏è VERY HIGH
- **Contains:** Malware source code
- **Special Notes:**
  - Compilable malware source
  - Educational but dangerous if compiled
  - Review code before attempting to build

### pan-unit42/iocs (Safe)

- **Risk Level:** ‚úÖ LOW
- **Contains:** Indicators of Compromise (IOCs)
- **Special Notes:** Hashes and signatures only, no live samples

### MalwareBazaar (Safe)

- **Risk Level:** ‚úÖ LOW
- **Contains:** Malware metadata and hashes
- **Special Notes:** Information only, no live samples in repo

## üö´ What NOT To Do

### NEVER:

1. ‚ùå Extract malware on your host operating system
2. ‚ùå Run malware with network access enabled
3. ‚ùå Share malware samples publicly or irresponsibly
4. ‚ùå Transfer files from VM to host without sanitization
5. ‚ùå Disable host antivirus
6. ‚ùå Use same VM for malware analysis and other work
7. ‚ùå Assume you're safe because "it's just a test"
8. ‚ùå Run malware without understanding what it does
9. ‚ùå Store malware samples unencrypted
10. ‚ùå Grant admin/root privileges unnecessarily

## ‚úÖ Best Practices Checklist

### Setup Phase:

- [ ] Isolated VM/container configured
- [ ] Network completely disabled or host-only
- [ ] Multiple clean snapshots created
- [ ] Analysis tools installed
- [ ] Documentation system ready
- [ ] Incident response plan prepared

### Analysis Phase:

- [ ] Verified network isolation
- [ ] Loaded from clean snapshot
- [ ] Using static analysis first
- [ ] Monitoring all activities
- [ ] Taking notes and screenshots
- [ ] Time-boxing analysis sessions

### Cleanup Phase:

- [ ] Restored to clean snapshot
- [ ] Exported data sanitized
- [ ] Logs archived securely
- [ ] VM state verified
- [ ] Documentation completed

## üÜò Incident Response

### If Malware Escapes VM:

1. **Immediately:**
   - Disconnect host from network
   - Power off VM (don't save state)
   - Don't panic - follow your plan

2. **Assess:**
   - Check host system processes
   - Review network connections
   - Scan with antivirus

3. **Contain:**
   - Isolate affected systems
   - Change passwords from clean system
   - Review logs for lateral movement

4. **Recover:**
   - Restore VM from clean snapshot
   - Reinstall host OS if compromised
   - Review and improve isolation

5. **Learn:**
   - Document what went wrong
   - Update procedures
   - Share lessons (anonymously if needed)

## üìö Recommended Reading

### Books:
- "Practical Malware Analysis" by Michael Sikorski
- "The Art of Memory Forensics" by Michael Hale Ligh
- "Malware Analyst's Cookbook" by Michael Ligh

### Online Resources:
- [SANS DFIR](https://www.sans.org/digital-forensics-incident-response/)
- [Malware Unicorn RE101](https://malwareunicorn.org/workshops/re101.html)
- [Practical Malware Analysis Labs](https://practicalmalwareanalysis.com/labs/)

### Communities:
- Reddit: r/Malware, r/ReverseEngineering
- Twitter: #MalwareAnalysis, #DFIR
- Discord: Many malware analysis servers (research carefully)

## üéì Training Resources

### Free Courses:
- [OpenSecurityTraining](http://opensecuritytraining.info/)
- [Cybrary - Malware Analysis](https://www.cybrary.it/)
- [SANS Cyber Aces](https://www.cyberaces.org/)

### Virtual Malware Labs:
- [FLARE VM](https://github.com/mandiant/flare-vm) - Windows malware analysis VM
- [REMnux](https://remnux.org/) - Linux malware analysis toolkit
- [Cuckoo Sandbox](https://cuckoosandbox.org/) - Automated malware analysis

## ‚öñÔ∏è Legal Resources

### Research Laws:
- Computer Fraud and Abuse Act (CFAA) - United States
- Computer Misuse Act - United Kingdom  
- EU Cybersecurity Act - European Union
- Your local jurisdiction's laws

### Professional Organizations:
- [SANS Institute](https://www.sans.org/)
- [ISC2](https://www.isc2.org/)
- [FIRST](https://www.first.org/)

## üìû Support & Questions

### Before Contacting Support:

1. Review this document completely
2. Check [PHASE5_GUIDE.md](./PHASE5_GUIDE.md)
3. Search existing GitHub issues
4. Consult with your organization's security team

### Reporting Security Issues:

- **DO NOT** report live malware samples as security issues
- **DO** report if downloader introduces vulnerabilities
- **DO** suggest safety improvements

---

## Final Warning

**Malware analysis is inherently dangerous.** These guidelines significantly reduce risk but cannot eliminate it entirely. 

**You must:**
- Have proper training
- Use appropriate isolation
- Follow all safety procedures
- Take responsibility for your actions

**If you're unsure or uncomfortable with these risks, use the `--skip-malware` flag.**

---

**Last Updated:** 2026-02-10  
**Maintainer:** See project README for contact information

Stay safe and happy researching! üõ°Ô∏èüîí
